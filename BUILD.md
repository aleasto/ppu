Thu Apr  7 15:12:58 CEST 2022, `75e206e`
# Build instructions
From brand new Ubuntu machine to autogenerated `ppu_top.v` verilog ppu core.

---


1. prepare for [Python](https://www.python.org/) installation via [pyenv](https://github.com/pyenv/pyenv)

    1.0. update apt registry

        sudo apt update

    1.1. install prerequisites of Python and pyenv

        sudo apt-get install -y build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python-openssl git unzip

    1.2 clone and install pyenv 
        
        git clone https://github.com/pyenv/pyenv.git ~/.pyenv

        echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.bashrc
        echo 'export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.bashrc
        echo -e 'if command -v pyenv 1>/dev/null 2>&1; then\n eval "$(pyenv init --path)"\nfi' >> ~/.bashrc

        exec $SHELL
        source .bashrc

2. install Python3.10.0 via pyenv

        pyenv install 3.10.0
        pyenv global 3.10.0


3. install [maturin](https://github.com/PyO3/maturin) via python package manager `pip`
        
        pip install maturin


4. install [Rust](https://www.rust-lang.org/) toolchain
        
        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
        source $HOME/.cargo/env


5. [generate ssh keys to access for github](https://docs.github.com/en/authentication/connecting-to-github-with-ssh)?
    
        ssh-keygen
        cat .ssh/id_rsa.pub
    


6. download and install the [hardposit](https://github.com/urbanij/hardposit) library
    
        git clone git@github.com:urbanij/hardposit.git
        cd hardposit/bindings/py-hardposit
        make



7. install the [system]verilog tools:
    
    7.1. compiler/simulator [icarus verilog](https://github.com/steveicarus/iverilog)

        # brew install icarus-verilog
        sudo apt install -y iverilog
    
    7.2. [gtkwave](http://gtkwave.sourceforge.net/) waveform viewer

        sudo apt install -y gtkwave
    
    7.3. [yosys](https://github.com/YosysHQ/yosys) synthesis tool (optional)
        
        sudo apt install -y yosys # optionally


8. optionally, download and intall the [verible](https://chipsalliance.github.io/verible/) [system]verilog code formatter

        wget https://github.com/chipsalliance/verible/releases/download/v0.0-2130-gb11bba24/verible-v0.0-2130-gb11bba24-Ubuntu-18.04-bionic-x86_64.tar.gz
        tar -xf verible-v0.0-2130-gb11bba24-Ubuntu-18.04-bionic-x86_64.tar.gz
        sudo cp verible-v0.0-2130-gb11bba24/bin/verible-verilog-format /usr/local/bin/

9. optionally, download and install the [system]verilog [slang](https://github.com/MikePopoloski/slang) code linter

        wget https://github.com/MikePopoloski/slang/releases/download/v0.9/slang-linux.tar.gz
        tar -xf slang-linux.tar.gz
        sudo cp slang/bin/slang /usr/local/bin/


10. download and install the systemverilog to verilog [sv2v](https://github.com/zachjs/sv2v) converter
        
        wget https://github.com/zachjs/sv2v/releases/download/v0.0.9/sv2v-Linux.zip
        unzip sv2v-Linux.zip
        sudo cp sv2v-Linux/sv2v /usr/local/bin/


11. setup the working directories

        mkdir RISCV-PPU
        cd RISCV-PPU

    11.1. clone the repos locally
    note: the `ppu` folder and `the PACoGen` folder has to be in this relative position in order for the comparison to work

            git clone git@bitbucket.org:riscv-ppu/ppu.git
            git clone git@bitbucket.org:riscv-ppu/pacogen.git PACoGen


    11.2. cd into ppu and export the env variables inside `.env`.
    
        cd ppu
        source .env

    11.3. checkout the pipeline branch, or checkout the exact commit I'm writing this file at:
    
        git checkout pipeline 
        # git checkout 75e206e


    11.4. run the script that generate the test vectors
    
        make gen-test-vectors

    11.5. generate `ppu_top.v` inside `./fpga/quartus/ppu_top.v` and `./fpga/vivado/ppu_top.v` and run the simulations:
    
        make ppu WORD=64 F=32 N=8 ES=0

    11.6. run the simulation
    
        make tb_pipelined WORD=64 F=32 N=16 ES=1

    11.7. open the waveforms
    
        gtkwave sim/waveforms/tb_ppu_pipelined_P16E1.vcd


